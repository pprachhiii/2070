generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Each user simulation run
model Simulation {
  id        Int               @id @default(autoincrement())
  profileId String?           // anonymous or logged-in user ID
  name      String?           // optional label (e.g. "Vegan lifestyle")
  choices   Json              // diet, transport, hobbies, etc.
  results   SimulationResult? // 1:1 relation
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// Results broken into categories
model SimulationResult {
  id             Int         @id @default(autoincrement())
  simulation     Simulation  @relation(fields: [simulationId], references: [id])
  simulationId   Int         @unique   // ðŸ”¹ Add @unique to fix the one-to-one relation

  environment    Json        // { co2: 350, temperature: 1.7, seaLevel: 0.4, biodiversity: "high" }
  humans         Json        // { health: "improved", foodSecurity: "stable", migration: "low" }
  animals        Json        // { extinctionRisk: "low", habitatLoss: "medium", populationTrend: "stable" }
}
